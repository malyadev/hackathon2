{% extends 'base.html.twig' %}

{% block title %}
    Welcome to your prescriptions index
{% endblock %}

{% block navbar %}
    <nav class="navbar navbar-expand-lg navbar-light d-flex justify-content-end" style="background-color: #28a745">
        {% if app.user.roles[0] == 'ROLE_PHARMACIST' %}
            <p class="mt-3 mr-3">Logged as a pharmacist</p>
            <img class="mr-3" src="/pharmacards/image2.jpg" style="width: 70px">
        {% elseif app.user.roles[0] == 'ROLE_PRACTITIONER' %}
            <p class="mt-3 mr-3">Logged as a practitioner</p>
            <img class="mr-3" src="/images/image5.png" style="width: 50px">
        {% endif %}

        <div class="col-1">
            {% if app.user %}
                <a href="{{ path('app_logout') }}" class="btn btn-outline-light my-2 my-sm-0"> Logout</a>
            {% endif %}
        </div>
    </nav>
{% endblock %}

{% block body %}
    <h1 class="my-5">Welcome to your prescriptions</h1>

    {% if is_granted('ROLE_PRACTITIONER') %}
        <div class="container-fluid d-flex justify-content-center my-3 ">
            <a class="btn btn-outline-success" href="{{ path('prescription_new') }}">Add a new patient prescription</a>
        </div>
    {%  endif %}

    <div class="container">
        <table class="table table-hover">
            <thead class="thead-light">
            <tr>
                <th>Prescription Id</th>
                <th>Firstname</th>
                <th>Lastname</th>
                <th class="text-center">Social security number</th>
                <th></th>
                {% if is_granted('ROLE_PHARMACIST') %}
                <th>Status</th>
                {% endif %}
            </tr>
            </thead>
            <tbody>
            {% for prescription in prescriptions%}
                <tr>
                    <td>{{ prescription.id }}</td>
                    <td>{{ prescription.user.firstname }}</td>
                    <td>{{ prescription.user.lastname }}</td>
                    <td class="text-center">{{ prescription.user.socialNumber }}</td>
                    <td>
                        <a class="btn btn-outline-dark" href="{{ path('prescription_edit', {'id': prescription.id}) }}">
                            {% if app.user.roles[0] == 'ROLE_PHARMACIST' %}
                                Show
                            {% elseif app.user.roles[0] == 'ROLE_PRACTITIONER' %}
                                Edit
                            {% endif %}
                        </a>
                    </td>
                    {% if is_granted('ROLE_PHARMACIST') %}
                    <td>{% if not prescription.delivery is null %}
                            <div class="text-success px-2 rounded">
                                <svg class="bi bi-check2-square" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M15.354 2.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L8 9.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                    <path fill-rule="evenodd" d="M1.5 13A1.5 1.5 0 0 0 3 14.5h10a1.5 1.5 0 0 0 1.5-1.5V8a.5.5 0 0 0-1 0v5a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5h8a.5.5 0 0 0 0-1H3A1.5 1.5 0 0 0 1.5 3v10z"/>
                                </svg>
                            </div>
                        {% elseif not prescription.preparation is null %}
                            <div class="text-info px-2 rounded">
                                <svg class="bi bi-bag-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M14 5H2v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V5zM1 4v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4H1z"/>
                                    <path d="M8 1.5A2.5 2.5 0 0 0 5.5 4h-1a3.5 3.5 0 1 1 7 0h-1A2.5 2.5 0 0 0 8 1.5z"/>
                                    <path fill-rule="evenodd" d="M10.854 7.646a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 10.293l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                                </svg>
                            </div>
                        {% elseif not prescription.buy is null %}
                            <div class="text-warning px-2">
                                <svg class="bi bi-bell" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2z"/>
                                    <path fill-rule="evenodd" d="M8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z"/>
                                </svg>
                            </div>
                        {% endif %}
                    </td>
                    {% endif %}
                </tr>
            {% else %}
                <tr>
                    <td colspan="2">no records found</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
